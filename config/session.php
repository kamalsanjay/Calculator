<?php
/**
 * Session Configuration
 * Session and cookie settings
 */

// Prevent direct access
defined('APP_ACCESS') or die('Direct access not permitted');

return [
    /*
    |--------------------------------------------------------------------------
    | Session Driver
    |--------------------------------------------------------------------------
    | Values: file, database, redis, memcached
    */
    'driver' => 'file',

    /*
    |--------------------------------------------------------------------------
    | Session Lifetime
    |--------------------------------------------------------------------------
    | In seconds (7200 = 2 hours)
    */
    'lifetime' => (int) getenv('SESSION_LIFETIME') ?: 7200,

    /*
    |--------------------------------------------------------------------------
    | Session File Location
    |--------------------------------------------------------------------------
    */
    'files' => CACHE_PATH . '/sessions',

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Name
    |--------------------------------------------------------------------------
    */
    'cookie' => getenv('SESSION_COOKIE_NAME') ?: 'calculator_session',

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Path
    |--------------------------------------------------------------------------
    */
    'path' => '/',

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Domain
    |--------------------------------------------------------------------------
    */
    'domain' => null,

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Secure
    |--------------------------------------------------------------------------
    | Set to true if using HTTPS
    */
    'secure' => filter_var(getenv('SESSION_COOKIE_SECURE') ?: false, FILTER_VALIDATE_BOOLEAN),

    /*
    |--------------------------------------------------------------------------
    | HTTP Only Cookies
    |--------------------------------------------------------------------------
    */
    'http_only' => filter_var(getenv('SESSION_COOKIE_HTTPONLY') ?: true, FILTER_VALIDATE_BOOLEAN),

    /*
    |--------------------------------------------------------------------------
    | Same Site Cookies
    |--------------------------------------------------------------------------
    | Values: lax, strict, none
    */
    'same_site' => 'lax',

    /*
    |--------------------------------------------------------------------------
    | Session Encryption
    |--------------------------------------------------------------------------
    */
    'encrypt' => false,

    /*
    |--------------------------------------------------------------------------
    | Session Table (for database driver)
    |--------------------------------------------------------------------------
    */
    'table' => 'sessions',

    /*
    |--------------------------------------------------------------------------
    | Session Store
    |--------------------------------------------------------------------------
    */
    'store' => null,

    /*
    |--------------------------------------------------------------------------
    | Session Lottery
    |--------------------------------------------------------------------------
    | Garbage collection probability
    */
    'lottery' => [2, 100], // [probability, divisor]

    /*
    |--------------------------------------------------------------------------
    | Session Regeneration
    |--------------------------------------------------------------------------
    */
    'regenerate' => [
        'on_login' => true,
        'on_logout' => true,
        'interval' => 600, // 10 minutes
    ],

    /*
    |--------------------------------------------------------------------------
    | Remember Me Configuration
    |--------------------------------------------------------------------------
    */
    'remember_me' => [
        'enabled' => true,
        'lifetime' => 30 * 24 * 60 * 60, // 30 days in seconds
        'cookie_name' => 'remember_token',
    ],

    /*
    |--------------------------------------------------------------------------
    | Session Activity Tracking
    |--------------------------------------------------------------------------
    */
    'tracking' => [
        'enabled' => true,
        'log_ip' => true,
        'log_user_agent' => true,
        'log_last_activity' => true,
    ],

    /*
    |--------------------------------------------------------------------------
    | Session Security
    |--------------------------------------------------------------------------
    */
    'security' => [
        'check_ip' => false,
        'check_user_agent' => true,
        'timeout_warning' => 300, // 5 minutes before timeout
    ],

    /*
    |--------------------------------------------------------------------------
    | Session Configuration Options
    |--------------------------------------------------------------------------
    */
    'options' => [
        'gc_maxlifetime' => 7200,
        'gc_probability' => 1,
        'gc_divisor' => 100,
        'cookie_lifetime' => 0,
        'cookie_httponly' => true,
        'use_strict_mode' => true,
        'use_cookies' => true,
        'use_only_cookies' => true,
        'cache_limiter' => 'nocache',
    ],
];